<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Design de Sobrancelhas</title>
    <link rel="stylesheet" href="./css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@100;200;300&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

<script>
    const API_URL = 'http://localhost:3000/api'; // Para desenvolvimento local
    // const API_URL = 'https://seu-app.onrender.com/api'; // Para produ√ß√£o (ajustar depois)

    // ========================================
    // CARREGAR SERVI√áOS DO BANCO
    // ========================================
    document.addEventListener('DOMContentLoaded', async function () {
        console.log('üîÑ Carregando servi√ßos...');

        try {
            const response = await fetch(`${API_URL}/servicos`);

            if (!response.ok) {
                throw new Error('Erro ao buscar servi√ßos');
            }

            const servicos = await response.json();
            console.log('‚úÖ Servi√ßos carregados:', servicos);

            const selectServico = document.getElementById('servico');
            selectServico.innerHTML = '<option value="">Selecione...</option>';

            servicos.forEach(servico => {
                const option = document.createElement('option');
                option.value = servico.id_servico;
                option.textContent = servico.nome_servico;
                selectServico.appendChild(option);
            });

        } catch (erro) {
            console.error('‚ùå Erro ao carregar servi√ßos:', erro);
            alert('‚ö†Ô∏è N√£o foi poss√≠vel carregar os servi√ßos. Verifique se a API est√° rodando.');
        }
    });

    // ========================================
    // PROCESSAR AGENDAMENTO
    // ========================================
    document.getElementById('formAgendamento').addEventListener('submit', async function (e) {
        e.preventDefault();

        const botao = this.querySelector('button[type="submit"]');
        const textoOriginal = botao.textContent;

        botao.disabled = true;
        botao.textContent = '‚è≥ Enviando...';

        // Pega o nome do servi√ßo, n√£o o ID
        const selectServico = document.getElementById('servico');
        const servicoNome = selectServico.options[selectServico.selectedIndex].text;

        const dados = {
            nome: document.getElementById('nome').value.trim(),
            telefone: document.getElementById('telefone').value.trim(),
            servico: servicoNome,
            data: document.getElementById('data').value,
            hora: document.getElementById('hora').value
        };

        console.log('üì§ Enviando agendamento:', dados);

        try {
            const response = await fetch(`${API_URL}/agendar`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(dados)
            });

            const resultado = await response.json();
            console.log('üì• Resposta da API:', resultado);

            if (response.ok && resultado.sucesso) {
                alert('‚úÖ ' + resultado.mensagem);
                this.reset();
            } else {
                alert('‚ùå ' + (resultado.erro || 'Erro ao agendar. Tente novamente.'));
            }
        } catch (erro) {
            console.error('‚ùå Erro:', erro);
            alert('‚ùå Erro ao conectar com o servidor. Verifique se a API est√° rodando.');
        } finally {
            botao.disabled = false;
            botao.textContent = textoOriginal;
        }
    });

    // ========================================
    // VERIFICAR DISPONIBILIDADE (OPCIONAL)
    // ========================================
    document.getElementById('data').addEventListener('change', async function () {
        const dataSelecionada = this.value;

        if (!dataSelecionada) return;

        console.log('üîç Verificando disponibilidade para:', dataSelecionada);

        try {
            const response = await fetch(`${API_URL}/disponibilidade?data=${dataSelecionada}`);
            const horasOcupadas = await response.json();

            if (horasOcupadas.length > 0) {
                console.log('üìÖ Hor√°rios j√° agendados:', horasOcupadas);
                // Aqui voc√™ pode implementar l√≥gica para desabilitar hor√°rios ocupados
            } else {
                console.log('‚úÖ Todos os hor√°rios dispon√≠veis');
            }
        } catch (erro) {
            console.error('‚ùå Erro ao verificar disponibilidade:', erro);
        }
    });
</script>

<body>

    <header>
        <img src="./imgs/logo2.PNG" alt="Logo do Studio" class="logo-img">
        <div>
            <h1 class="logo-text">Studio Adriana Soares</h1>
            <p>Realce sua beleza com naturalidade</p>
        </div>
    </header>

    <nav id="navegador">
        <ul>
            <a href="#quem-somos">Quem somos</a>
            <a href="#procedimentos">Procedimentos</a>
            <a href="#resultados">Resultados</a>
            <a href="#contato">Contato</a>
            <a href="#agendamento">Agendamento</a>
        </ul>
    </nav>

    <main class="container">
        <section id="quem-somos">
            <h2>Quem somos</h2>
            <div class="sobre-nos">
                <img src="./imgs/perfil.jpg" alt="Equipe de design de sobrancelhas">
                <div class="texto">
                    <p>Somos especialistas em design de sobrancelhas, com anos de experi√™ncia em real√ßar a beleza
                        natural dos nossos clientes.
                        Nosso est√∫dio oferece um atendimento personalizado, com t√©cnicas modernas e materiais de alta
                        qualidade.</p>
                </div>
            </div>
        </section>

        <section id="procedimentos">
            <h2>Procedimentos</h2>
            <div class="cards">

                <div class="card">
                    <img src="./imgs/sobrancelhanalinha1.jpg" alt="Design de Sobrancelha">
                    <h3>Design de Sobrancelha</h3>
                    <p>Remo√ß√£o precisa dos fios para um formato perfeito e natural.</p>
                </div>

                <div class="card">
                    <img src="./imgs/HennaColoracao.jpg" alt="Henna e colora√ß√£o">
                    <h3>Henna e colora√ß√£o</h3>
                    <p>Realce o olhar com pigmenta√ß√£o leve e duradoura.</p>
                </div>

                <div class="card">
                    <img src="./imgs/depilacaoCorporal.jpg" alt="Depila√ß√£o Corporal">
                    <h3>Depila√ß√£o Corporal</h3>
                    <p>Preenchimento delicado com efeito fio a fio.</p>
                </div>

                <div class="card">
                    <img src="./imgs/Laminacao.jpg" alt="Brow Lamination">
                    <h3>Brow Lamination</h3>
                    <p>Alinhamento e fixa√ß√£o dos fios para um olhar marcante e bem definido.</p>
                </div>

                <div class="card">
                    <img src="./imgs/SobrancelhaMasculina.jpg" alt="Design para homens">
                    <h3>Design para homens</h3>
                    <p>Modelagem discreta e natural, respeitando o formato facial masculino.</p>
                </div>

                <div class="card">
                    <img src="./imgs/depilacaofacial.jpg" alt="Depila√ß√£o facial">
                    <h3>Depila√ß√£o facial</h3>
                    <p>Remo√ß√£o delicada dos pelos do rosto para uma pele lisa e uniforme.</p>
                </div>

            </div>
        </section>



        <section id="resultados">
            <h2>Resultados</h2>
            <p>Confira alguns antes e depois:</p>
            <div class="antes-depois">
                <img src="./imgs/sobrancelhas1.jpg" alt="Antes e depois 1">
                <img src="./imgs/sobrancelhas2.jpg" alt="Antes e depois 2">
                <img src="./imgs/sobrancelhas3.jpg" alt="Antes e depois 3">
            </div>
        </section>


        <section id="agendamento">
            <h2>Agende seu hor√°rio online</h2>

            <form id="formAgendamento">
                <div class="campo">
                    <label for="nome">Nome:</label>
                    <input type="text" id="nome" name="nome" required>
                </div>

                <div class="campo">
                    <label for="telefone">Telefone:</label>
                    <input type="tel" id="telefone" name="telefone" required>
                </div>

                <div class="campo">
                    <label for="servico">Servi√ßo:</label>
                    <select id="servico" name="servico" required>
                        <option value="">Carregando servi√ßos...</option>
                    </select>
                </div>

                <div class="campo">
                    <label for="data">Data:</label>
                    <input type="date" id="data" name="data" required>
                </div>

                <div class="campo">
                    <label for="hora">Hora:</label>
                    <input type="time" id="hora" name="hora" required>
                </div>

                <button type="submit">Agendar</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Studio de Sobrancelhas. Todos os direitos reservados.</p>
    </footer>

</body>

</html>